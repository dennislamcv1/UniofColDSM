---
title: "Xbar and R / Xbar and S Charts / X and MR Charts Notebook"
output: html_notebook
---
```{r}

# Startup Code
require(lolcat)
require(spc)



# Load the data
data <- read.table("BagWeight.dat", header = TRUE, sep = "\t")

# Prepare the data for the SPC chart function
# The function expects a "measure" column (weights) and a "sample" column (week number)
xbar.r.column <- data.frame(
  measure = data$Bag_Weight,
  sample = data$Week
)

# Calculate the mean weight for each week (subgroup mean)
weekly_means <- aggregate(Bag_Weight ~ Week, data, mean)

# Calculate the overall centerline for the X̅ chart (the average of the subgroup means)
centerline_xbar <- mean(weekly_means$Bag_Weight)

# Print the result rounded to 4 decimal places
centerline_xbar <- round(centerline_xbar, 4)
print(centerline_xbar)


```

```{r}

# Calculate the range for each week
weekly_ranges <- aggregate(Bag_Weight ~ Week, data, function(x) max(x) - min(x))

# Calculate the overall centerline for the R chart (average of the ranges)
centerline_r <- mean(weekly_ranges$Bag_Weight)

# Print the centerline for the R chart rounded to 4 decimal places
centerline_r <- round(centerline_r, 4)
cat("Centerline for the R chart:", centerline_r, "\n")

```

```{r}
# Define the control chart factor A2 for a sample size of 5
A2 <- 0.577

# Calculate the UCL and LCL for the X̅ chart
UCL_xbar <- centerline_xbar + (A2 * centerline_r)
LCL_xbar <- centerline_xbar - (A2 * centerline_r)

# Print the UCL and LCL for the X̅ chart rounded to 4 decimal places
UCL_xbar <- round(UCL_xbar, 4)
LCL_xbar <- round(LCL_xbar, 4)
cat("Upper Control Limit for the X̅ chart:", UCL_xbar, "\n")
cat("Lower Control Limit for the X̅ chart:", LCL_xbar, "\n")

# Calculate the LCL for the R chart
D3 <- 0  # For a sample size of 5, D3 is 0, indicating no LCL
LCL_r <- D3 * centerline_r

# Print the LCL for the R chart (if it doesn't exist, it's NA)
if (LCL_r == 0) {
  cat("Lower Control Limit for the R chart: NA\n")
} else {
  LCL_r <- round(LCL_r, 4)
  cat("Lower Control Limit for the R chart:", LCL_r, "\n")
}


```

```{r}
# Create the X Bar and R Chart
spc.chart.variables.mean.and.meanrange(
  data = xbar.r.column$measure,
  sample = xbar.r.column$sample,
  chart1.main = "X̅ Chart",
  chart2.main = "R Chart"
)


```

